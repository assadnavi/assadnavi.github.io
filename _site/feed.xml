<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-06-10T11:08:06+02:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Functional programming with VBA</title><subtitle>My description.</subtitle><entry><title type="html">Function head() over a vba array</title><link href="http://localhost:4000/2023/06/07/function-head-over-a-vba-array.html" rel="alternate" type="text/html" title="Function head() over a vba array" /><published>2023-06-07T02:00:00+02:00</published><updated>2023-06-07T02:00:00+02:00</updated><id>http://localhost:4000/2023/06/07/function-head-over-a-vba-array</id><content type="html" xml:base="http://localhost:4000/2023/06/07/function-head-over-a-vba-array.html"><![CDATA[<p>One convenient way to solve a problem is to write recursive functions. The vba runtime environment allows use to write recursive functions but the tooling around (head, tail, cons, …) to process data recursively is not provided in the core language definition. In this blog, we are aiming to build the various missing functions needed to write vba code in a functional programming style. To do so, we will start building our first useful function, <code class="language-plaintext highlighter-rouge">head</code>. The function head has a different name depending on the programming language, as an example, it is called <code class="language-plaintext highlighter-rouge">car</code> in Scheme or Lisp. Its purpose is to return the first element of a list and it is defined only for non-empty lists. In this article, we are going to provide a vba implementation of the head function taking as a parameter an array. In the future, we will look at a more functional datastructure called cons instead of using arrays. See below its implementation.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Function</span> <span class="nf">head</span><span class="p">(</span><span class="n">xs</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Variant</span>

    <span class="k">If</span> <span class="n">IsEmpty</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Then</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">Empty</span>
    <span class="k">ElseIf</span> <span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Then</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">Empty</span>
    <span class="k">Else</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
    <span class="k">End</span> <span class="k">If</span>

<span class="k">End</span> <span class="k">Function</span></code></pre></figure>

<p><br />
The function takes an array (we keep the function generic by using the input and output type Variant) and returns the first item of its parameter. We assume here that the data is a valid array. In scenarios where the input array is not inititalized or empty, the function returns the value Empty. Why returning Empty ? In vba, Empty is used to define a non-value compared to Null which defines a non-valid value. An error could also have been returned but this makes the use of the function more difficult. See below how the function head can be used in a vba code.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

    <span class="k">Dim</span> <span class="nv">h</span> <span class="ow">As</span> <span class="kt">Variant</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">head</span><span class="p">(</span> <span class="n">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span>

    <span class="k">If</span> <span class="k">Not</span> <span class="n">IsEmpty</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">Then</span>
        <span class="c1">' ...</span>
    <span class="k">End</span> <span class="k">If</span>

<span class="k">End</span> <span class="k">Sub</span></code></pre></figure>

<p><br />
Thanks for reading. If you have any comments <a href="mailto:assad.navi@gmail.com">get in touch</a></p>]]></content><author><name></name></author><summary type="html"><![CDATA[One convenient way to solve a problem is to write recursive functions. The vba runtime environment allows use to write recursive functions but the tooling around (head, tail, cons, …) to process data recursively is not provided in the core language definition. In this blog, we are aiming to build the various missing functions needed to write vba code in a functional programming style. To do so, we will start building our first useful function, head. The function head has a different name depending on the programming language, as an example, it is called car in Scheme or Lisp. Its purpose is to return the first element of a list and it is defined only for non-empty lists. In this article, we are going to provide a vba implementation of the head function taking as a parameter an array. In the future, we will look at a more functional datastructure called cons instead of using arrays. See below its implementation. Function head(xs As Variant) As Variant]]></summary></entry></feed>