<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-06-20T12:46:08+02:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Functional programming with VBA</title><subtitle>My description.</subtitle><entry><title type="html">First recursive function in vba</title><link href="http://localhost:4000/2023/06/19/first-recursive-function-in-vba.html" rel="alternate" type="text/html" title="First recursive function in vba" /><published>2023-06-19T02:00:00+02:00</published><updated>2023-06-19T02:00:00+02:00</updated><id>http://localhost:4000/2023/06/19/first-recursive-function-in-vba</id><content type="html" xml:base="http://localhost:4000/2023/06/19/first-recursive-function-in-vba.html"><![CDATA[<p>Finally we got to the point where we can write our first recursive function. In this article, we will write a recursive function in vba to solve the array membership problem, which can be stated as : For a given array and value, is the value contained in the array ? You can see the logic of the function below.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">Is</span> <span class="mi">1</span> <span class="n">contained</span> <span class="n">in</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="n">Yes</span>

<span class="n">Is</span> <span class="mi">8</span> <span class="n">contained</span> <span class="n">in</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="o">?</span> <span class="n">No</span>

<span class="n">Is</span> <span class="s">"z"</span> <span class="n">contained</span> <span class="n">in</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">]</span> <span class="o">?</span> <span class="n">No</span></code></pre></figure>

<p><br />
 The idea of using recursive functions is to solve the entire problem by solving a smaller piece of it multiple times. To do so, we are going to be helped by the functions <code class="language-plaintext highlighter-rouge">head()</code> and <code class="language-plaintext highlighter-rouge">tail()</code> that have been implemented in previous articles. See references <a href="http://localhost:4000/2023/05/29/function-head-over-a-vba-array.html">head()</a>, <a href="http://localhost:4000/2023/06/05/function-tail-over-a-vba-array.html">tail()</a>. Here is a quick reminder of those two functions.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">head</span> <span class="n">of</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">]</span> <span class="n">is</span> <span class="s">"a"</span>

<span class="n">head</span> <span class="n">of</span> <span class="n">a</span> <span class="n">empty</span><span class="o">-</span><span class="n">array</span> <span class="n">is</span> <span class="n">not</span> <span class="n">defined</span>

<span class="n">tail</span> <span class="n">of</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">]</span> <span class="n">is</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">]</span>

<span class="n">tail</span> <span class="n">of</span> <span class="n">a</span> <span class="n">empty</span><span class="o">-</span><span class="n">array</span> <span class="n">is</span> <span class="n">not</span> <span class="n">defined</span></code></pre></figure>

<p><br />
In this article, for simplicity for the reader, I will not discuss the entire theory about recursive functions but rather provide a pragmatic introduction. To explain the recursive procedure to solve the array membership problem, I will use an example and display all the required steps.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="c1">// Start</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">contained</span> <span class="n">in</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">?</span>

<span class="c1">// Step 1</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">equal</span> <span class="n">to</span> <span class="mi">3</span> <span class="o">?</span> <span class="n">No</span><span class="p">.</span> <span class="n">Start</span> <span class="n">again</span> <span class="n">with</span> <span class="n">array</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1">// Step 2</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">equal</span> <span class="n">to</span> <span class="mi">2</span> <span class="o">?</span> <span class="n">No</span><span class="p">,</span> <span class="n">Start</span> <span class="n">again</span> <span class="n">with</span> <span class="n">array</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">// Step 3</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">equal</span> <span class="n">to</span> <span class="mi">1</span> <span class="o">?</span> <span class="n">Yes</span><span class="p">,</span> <span class="mi">1</span> <span class="n">is</span> <span class="n">equal</span> <span class="n">to</span> <span class="mi">1</span></code></pre></figure>

<p><br />
Now that we have the steps, let me show you the same example by displaying where the functions head() and tail() are used.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="c1">// Start</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">contained</span> <span class="n">in</span> <span class="n">the</span> <span class="n">array</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">?</span>

<span class="c1">// Step 1</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">head</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">?</span> <span class="n">No</span><span class="p">.</span> <span class="n">Start</span> <span class="n">again</span> <span class="n">with</span> <span class="n">tail</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1">// Step 2</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">head</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">?</span> <span class="n">No</span><span class="p">.</span> <span class="n">Start</span> <span class="n">again</span> <span class="n">with</span> <span class="n">tail</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1">// Step 3</span>
<span class="n">Is</span> <span class="mi">1</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">head</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span> <span class="o">?</span> <span class="n">Yes</span></code></pre></figure>

<p><br />
Vba implementation : The function is called <code class="language-plaintext highlighter-rouge">isMember</code> and takes two parameters, one value and one array. The function returns a boolean, true if the value is contained in the array otherwise false. In this implementation, it is assumed that the caller has checked that the parameters are initialized and of the correct type before calling this function. Additionally for code clarity, we have added a helper function <code class="language-plaintext highlighter-rouge">isArrayEmpty</code> which returns true if and only if its parameter is an empty array.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Function</span> <span class="nf">isMember</span><span class="p">(</span><span class="n">x</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">,</span> <span class="n">xs</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>

    <span class="k">If</span> <span class="n">isArrayEmpty</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Then</span>
        <span class="n">isMember</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">ElseIf</span> <span class="n">head</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span> <span class="k">Then</span>
        <span class="n">isMember</span> <span class="o">=</span> <span class="k">True</span>
    <span class="k">Else</span>
        <span class="n">isMember</span> <span class="o">=</span> <span class="n">isMember</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tail</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
    <span class="k">End</span> <span class="k">If</span>

<span class="k">End</span> <span class="k">Function</span>

<span class="k">Function</span> <span class="nf">isArrayEmpty</span><span class="p">(</span><span class="n">xs</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>

    <span class="n">isArrayEmpty</span> <span class="o">=</span> <span class="p">(</span><span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">-</span> <span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">End</span> <span class="k">Function</span></code></pre></figure>

<p><br />
The first if-condition statement, from this code, is called the <code class="language-plaintext highlighter-rouge">base case</code> of the recursion. We reach this scenario when the array parameter is empty and therefore we know that the answer is false. How can this function be used in a vba code ?
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

    <span class="k">Dim</span> <span class="nv">r</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">isMember</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="c1">' r is true</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">isMember</span><span class="p">(</span><span class="s">"z"</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span> <span class="s">"y"</span><span class="p">,</span> <span class="s">"z"</span><span class="p">))</span>
    <span class="c1">' r is true</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">isMember</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="c1">' r is false</span>

<span class="k">End</span> <span class="k">Sub</span></code></pre></figure>

<p><br />
Thanks for reading. If you have any comments <a href="mailto:hello@assadnavi.ch">get in touch</a>.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[Finally we got to the point where we can write our first recursive function. In this article, we will write a recursive function in vba to solve the array membership problem, which can be stated as : For a given array and value, is the value contained in the array ? You can see the logic of the function below.]]></summary></entry><entry><title type="html">What can be cons() in vba ?</title><link href="http://localhost:4000/2023/06/12/what-can-be-cons-in-vba.html" rel="alternate" type="text/html" title="What can be cons() in vba ?" /><published>2023-06-12T02:00:00+02:00</published><updated>2023-06-12T02:00:00+02:00</updated><id>http://localhost:4000/2023/06/12/what-can-be-cons-in-vba</id><content type="html" xml:base="http://localhost:4000/2023/06/12/what-can-be-cons-in-vba.html"><![CDATA[<p>The last tool we need before solving our first problem with a recursive approach is <code class="language-plaintext highlighter-rouge">cons</code>. In functional programming, <code class="language-plaintext highlighter-rouge">cons</code> is a datastructure which holds a pair of things (I say ‘things’ because they can be either a value or a reference). A cons is simply a pair (a, b). This datastructure can be used to represent a list of items. See below an example.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">The</span> <span class="n">list</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">can</span> <span class="n">be</span> <span class="n">constructed</span> <span class="n">as</span> <span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span>

<span class="n">The</span> <span class="n">list</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="n">can</span> <span class="n">be</span> <span class="n">constructed</span> <span class="n">as</span> <span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cons</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">empty</span><span class="p">))</span>

<span class="n">Where</span> <span class="n">empty</span> <span class="n">is</span> <span class="n">any</span> <span class="n">symbol</span> <span class="n">that</span> <span class="n">represents</span> <span class="n">a</span> <span class="n">non</span><span class="o">-</span><span class="n">value</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">g</span><span class="p">.</span> <span class="n">Empty</span> <span class="n">in</span> <span class="n">vba</span><span class="p">)</span></code></pre></figure>

<p><br />
The advantage of using cons to build list is that <code class="language-plaintext highlighter-rouge">head()</code> and <code class="language-plaintext highlighter-rouge">tail()</code> become trivial (respectively retrieving the first or the second elements of the pair). We call <code class="language-plaintext highlighter-rouge">consing</code> the operation of adding an element at a beginning of a list. A basic approach to build a cons in vba will be to base it on arrays and create a function to add a value at a beginning of an existing array. By doing so, we will be able to reuse the implemented functions head() and tail() over its output. The function cons() takes two parameters, a value and an array, and returns an array. Here are some examples showing the function logic.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">cons</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">and</span> <span class="n">array</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">cons</span> <span class="n">of</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">array</span> <span class="p">[]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">cons</span> <span class="n">of</span> <span class="s">"a"</span> <span class="n">and</span> <span class="n">array</span> <span class="p">[</span><span class="s">"b"</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></code></pre></figure>

<p><br />
See below the implementation of the function cons(). It is assumed that the caller will pass initialized and valid data for both of its parameters. This implementation is generic therefore can be used with any array types.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Function</span> <span class="nf">cons</span><span class="p">(</span><span class="n">x</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">,</span> <span class="n">xs</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Variant</span>

    <span class="k">Dim</span> <span class="nv">result</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Variant</span>
    <span class="k">ReDim</span> <span class="n">result</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>

    <span class="n">result</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">To</span> <span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Step</span> <span class="mi">1</span>
        <span class="n">result</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">Next</span>
    <span class="n">cons</span> <span class="o">=</span> <span class="n">result</span>

<span class="k">End</span> <span class="k">Function</span></code></pre></figure>

<p><br />
How can this function be used in a vba code ?
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

    <span class="k">Dim</span> <span class="nv">r</span> <span class="ow">As</span> <span class="kt">Variant</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">Array</span><span class="p">())</span>
    <span class="c1">' r is the array ["a"]</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">))</span>
    <span class="c1">' r is the array ["a", "b", "c"]</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">cons</span><span class="p">(</span><span class="s">"z"</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
    <span class="c1">' r is the array ["a", "z", 1, 2, 3]</span>

<span class="k">End</span> <span class="k">Sub</span></code></pre></figure>

<p><br />
Thanks for reading. If you have any comments <a href="mailto:hello@assadnavi.ch">get in touch</a>.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[The last tool we need before solving our first problem with a recursive approach is cons. In functional programming, cons is a datastructure which holds a pair of things (I say ‘things’ because they can be either a value or a reference). A cons is simply a pair (a, b). This datastructure can be used to represent a list of items. See below an example.]]></summary></entry><entry><title type="html">Function tail() over a vba array</title><link href="http://localhost:4000/2023/06/05/function-tail-over-a-vba-array.html" rel="alternate" type="text/html" title="Function tail() over a vba array" /><published>2023-06-05T02:00:00+02:00</published><updated>2023-06-05T02:00:00+02:00</updated><id>http://localhost:4000/2023/06/05/function-tail-over-a-vba-array</id><content type="html" xml:base="http://localhost:4000/2023/06/05/function-tail-over-a-vba-array.html"><![CDATA[<p>In this article, we will look at our second tool that will help us solve problems in a recursive programming style. The function is called <code class="language-plaintext highlighter-rouge">tail</code>. The function takes an array as a parameter and returns a copy of it without its first element. The order of the elements is preserved. The function tail is defined only for non-empty arrays. See examples of its logic.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">tail</span> <span class="n">of</span> <span class="n">array</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="n">tail</span> <span class="n">of</span> <span class="n">array</span> <span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="s">"b"</span><span class="p">]</span>

<span class="n">tail</span> <span class="n">of</span> <span class="n">array</span> <span class="p">[</span><span class="s">"z"</span><span class="p">]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[]</span>

<span class="n">tail</span> <span class="n">of</span> <span class="n">array</span> <span class="p">[]</span> <span class="n">is</span> <span class="n">not</span> <span class="n">defined</span>

<span class="n">tail</span> <span class="n">of</span> <span class="n">non</span><span class="o">-</span><span class="n">array</span> <span class="n">is</span> <span class="n">not</span> <span class="n">defined</span></code></pre></figure>

<p><br />
It is important to note that the function <code class="language-plaintext highlighter-rouge">tail</code> returns a new array and keep the original array unchanged (no side-effect). In the functional programming style, it is the responsibility of the caller to verify that the input array is non-empty before calling the function tail. In this article, we will provide a vba implementation of this function.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Function</span> <span class="nf">tail</span><span class="p">(</span><span class="n">xs</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Variant</span>

    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="nv">result</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Variant</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">Array</span><span class="p">()</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">To</span> <span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Step</span> <span class="mi">1</span>
        <span class="k">ReDim</span> <span class="n">Preserve</span> <span class="n">result</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">result</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">Next</span>
    <span class="n">tail</span> <span class="o">=</span> <span class="n">result</span>
    
<span class="k">End</span> <span class="k">Function</span></code></pre></figure>

<p><br />
Once this function is defined, you can call it in a vba code as below. As a reminder, the function tail will produce a run-time error if an empty or an uninitialized array is passed as its parameter. It is the responsibility of the caller to check its input before calling the function. A post will be written to cover this subject.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

    <span class="k">Dim</span> <span class="nv">t</span> <span class="ow">As</span> <span class="kt">Variant</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">tail</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">))</span>
    <span class="n">MsgBox</span> <span class="n">t</span>

<span class="k">End</span> <span class="k">Sub</span></code></pre></figure>

<p><br />
In the future, we will rework this example to implement it over a more functional datastructure called <code class="language-plaintext highlighter-rouge">cons</code>. Thanks for reading. If you have any comments <a href="mailto:hello@assadnavi.ch">get in touch</a>.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[In this article, we will look at our second tool that will help us solve problems in a recursive programming style. The function is called tail. The function takes an array as a parameter and returns a copy of it without its first element. The order of the elements is preserved. The function tail is defined only for non-empty arrays. See examples of its logic.]]></summary></entry><entry><title type="html">Function head() over a vba array</title><link href="http://localhost:4000/2023/05/29/function-head-over-a-vba-array.html" rel="alternate" type="text/html" title="Function head() over a vba array" /><published>2023-05-29T02:00:00+02:00</published><updated>2023-05-29T02:00:00+02:00</updated><id>http://localhost:4000/2023/05/29/function-head-over-a-vba-array</id><content type="html" xml:base="http://localhost:4000/2023/05/29/function-head-over-a-vba-array.html"><![CDATA[<p>One convenient way to solve a problem is to write recursive functions. The vba runtime environment allows use to write recursive functions but the tooling around (head, tail, cons, …) to process data recursively is not provided in the core language definition. In this blog, we are aiming to build the various missing functions needed to write vba code in a functional programming style. To do so, we will start building our first useful function, <code class="language-plaintext highlighter-rouge">head</code>. The function head has a different name depending on the programming language, as an example, it is called <code class="language-plaintext highlighter-rouge">car</code> in Scheme or Lisp. Its purpose is to return the first element of a list and it is defined only for non-empty lists. In this article, we are going to provide a vba implementation of the head function taking as a parameter an array. In the future, we will look at a more functional datastructure called cons instead of using arrays. See below its implementation.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Function</span> <span class="nf">head</span><span class="p">(</span><span class="n">xs</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Variant</span>

    <span class="k">If</span> <span class="n">IsEmpty</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Then</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">Empty</span>
    <span class="k">ElseIf</span> <span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Then</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">Empty</span>
    <span class="k">Else</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
    <span class="k">End</span> <span class="k">If</span>

<span class="k">End</span> <span class="k">Function</span></code></pre></figure>

<p><br />
The function takes an array (we keep the function generic by using the input and output type Variant) and returns the first item of its parameter. We assume here that the data is a valid array. In scenarios where the input array is not inititalized or empty, the function returns the value Empty. Why returning Empty ? In vba, Empty is used to define a non-value compared to Null which defines a non-valid value. An error could also have been returned but this makes the use of the function more difficult. See below how the function head can be used in a vba code.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

    <span class="k">Dim</span> <span class="nv">h</span> <span class="ow">As</span> <span class="kt">Variant</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">head</span><span class="p">(</span> <span class="n">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span>

    <span class="k">If</span> <span class="k">Not</span> <span class="n">IsEmpty</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">Then</span>
        <span class="c1">' ...</span>
    <span class="k">End</span> <span class="k">If</span>

<span class="k">End</span> <span class="k">Sub</span></code></pre></figure>

<p><br />
Thanks for reading. If you have any comments <a href="mailto:hello@assadnavi.ch">get in touch</a>.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[One convenient way to solve a problem is to write recursive functions. The vba runtime environment allows use to write recursive functions but the tooling around (head, tail, cons, …) to process data recursively is not provided in the core language definition. In this blog, we are aiming to build the various missing functions needed to write vba code in a functional programming style. To do so, we will start building our first useful function, head. The function head has a different name depending on the programming language, as an example, it is called car in Scheme or Lisp. Its purpose is to return the first element of a list and it is defined only for non-empty lists. In this article, we are going to provide a vba implementation of the head function taking as a parameter an array. In the future, we will look at a more functional datastructure called cons instead of using arrays. See below its implementation. Function head(xs As Variant) As Variant]]></summary></entry></feed>