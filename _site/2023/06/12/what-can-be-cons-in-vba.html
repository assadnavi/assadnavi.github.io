<!DOCTYPE html>
<html lang="en"><head>
  <meta name="description" content="Functional programming with VBA">
  <meta name="keywords" content="VBA, Programming, Functional, FP, Recursive, Visual Basic, Excel">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>What can be cons() in vba ? | Functional programming with VBA</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="What can be cons() in vba ?" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The last tool we need before solving our first problem with a recursive approach is cons. In functional programming, cons is a datastructure which holds a pair of things (I say ‘things’ because they can be either a value or a reference). A cons is simply a pair (a, b). This datastructure can be used to represent a list of items. See below an example." />
<meta property="og:description" content="The last tool we need before solving our first problem with a recursive approach is cons. In functional programming, cons is a datastructure which holds a pair of things (I say ‘things’ because they can be either a value or a reference). A cons is simply a pair (a, b). This datastructure can be used to represent a list of items. See below an example." />
<link rel="canonical" href="http://localhost:4000/2023/06/12/what-can-be-cons-in-vba.html" />
<meta property="og:url" content="http://localhost:4000/2023/06/12/what-can-be-cons-in-vba.html" />
<meta property="og:site_name" content="Functional programming with VBA" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-06-12T02:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="What can be cons() in vba ?" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-06-12T02:00:00+02:00","datePublished":"2023-06-12T02:00:00+02:00","description":"The last tool we need before solving our first problem with a recursive approach is cons. In functional programming, cons is a datastructure which holds a pair of things (I say ‘things’ because they can be either a value or a reference). A cons is simply a pair (a, b). This datastructure can be used to represent a list of items. See below an example.","headline":"What can be cons() in vba ?","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/06/12/what-can-be-cons-in-vba.html"},"url":"http://localhost:4000/2023/06/12/what-can-be-cons-in-vba.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="/favicon.png"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Functional programming with VBA" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Functional programming with VBA</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">What can be cons() in vba ?</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-06-12T02:00:00+02:00" itemprop="datePublished">Jun 12, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>The last tool we need before solving our first problem with a recursive approach is <code class="language-plaintext highlighter-rouge">cons</code>. In functional programming, <code class="language-plaintext highlighter-rouge">cons</code> is a datastructure which holds a pair of things (I say ‘things’ because they can be either a value or a reference). A cons is simply a pair (a, b). This datastructure can be used to represent a list of items. See below an example.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">The</span> <span class="n">list</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">can</span> <span class="n">be</span> <span class="n">constructed</span> <span class="n">as</span> <span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span>

<span class="n">The</span> <span class="n">list</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="n">can</span> <span class="n">be</span> <span class="n">constructed</span> <span class="n">as</span> <span class="n">cons</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cons</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">empty</span><span class="p">))</span>

<span class="n">Where</span> <span class="n">empty</span> <span class="n">is</span> <span class="n">any</span> <span class="n">symbol</span> <span class="n">that</span> <span class="n">represents</span> <span class="n">a</span> <span class="n">non</span><span class="o">-</span><span class="n">value</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">g</span><span class="p">.</span> <span class="n">Empty</span> <span class="n">in</span> <span class="n">vba</span><span class="p">)</span></code></pre></figure>

<p><br />
The advantage of using cons to build list is that <code class="language-plaintext highlighter-rouge">head()</code> and <code class="language-plaintext highlighter-rouge">tail()</code> become trivial (respectively retrieving the first or the second elements of the pair). We call <code class="language-plaintext highlighter-rouge">consing</code> the operation of adding an element at a beginning of a list. A basic approach to build a cons in vba will be to base it on arrays and create a function to add a value at a beginning of an existing array. By doing so, we will be able to reuse the implemented functions head() and tail() over its output. The function cons() takes two parameters, a value and an array, and returns an array. Here are some examples showing the function logic.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">cons</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">and</span> <span class="n">array</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">cons</span> <span class="n">of</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">array</span> <span class="p">[]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">cons</span> <span class="n">of</span> <span class="s">"a"</span> <span class="n">and</span> <span class="n">array</span> <span class="p">[</span><span class="s">"b"</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="n">is</span> <span class="n">array</span> <span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></code></pre></figure>

<p><br />
See below the implementation of the function cons(). It is assumed that the caller will pass initialized and valid data for both of its parameters. This implementation is generic therefore can be used with any array types.
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Function</span> <span class="nf">cons</span><span class="p">(</span><span class="n">x</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">,</span> <span class="n">xs</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Variant</span>

    <span class="k">Dim</span> <span class="nv">result</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Variant</span>
    <span class="k">ReDim</span> <span class="n">result</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>

    <span class="n">result</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="n">LBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">To</span> <span class="n">UBound</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="k">Step</span> <span class="mi">1</span>
        <span class="n">result</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">Next</span>
    <span class="n">cons</span> <span class="o">=</span> <span class="n">result</span>

<span class="k">End</span> <span class="k">Function</span></code></pre></figure>

<p><br />
How can this function be used in a vba code ?
<br /><br /></p>

<figure class="highlight"><pre><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

    <span class="k">Dim</span> <span class="nv">r</span> <span class="ow">As</span> <span class="kt">Variant</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">Array</span><span class="p">())</span>
    <span class="c1">' r is the array ["a"]</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">))</span>
    <span class="c1">' r is the array ["a", "b", "c"]</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">cons</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">cons</span><span class="p">(</span><span class="s">"z"</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
    <span class="c1">' r is the array ["a", "z", 1, 2, 3]</span>

<span class="k">End</span> <span class="k">Sub</span></code></pre></figure>

<p><br />
Thanks for reading. If you have any comments <a href="mailto:hello@assadnavi.ch">get in touch</a>.</p>

  </div><a class="u-url" href="/2023/06/12/what-can-be-cons-in-vba.html" hidden></a>
</article>

      </div>
    </main>

    <!--<footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Functional programming with VBA</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Functional programming with VBA</li><li><a class="u-email" href="mailto:hello@assadnavi.ch">hello@assadnavi.ch</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>My description.</p>
      </div>
    </div>

  </div>

</footer>
-->

  </body>

</html>
